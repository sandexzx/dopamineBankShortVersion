#!/bin/bash

# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Dopamine Bank Ð½Ð° Ubuntu 24.04
# ÐÐ²Ñ‚Ð¾Ñ€: ÐšÑ€ÑƒÑ‚Ð¾Ð¹ ÐºÐ¾Ð´ÐµÑ€

# Ð¦Ð²ÐµÑ‚Ð° Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð°
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m' # No Color

# Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ ÐºÑ€Ð°ÑÐ¸Ð²Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°
log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚
check_dependencies() {
    log_info "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹..."
    
    # ÐœÐ°ÑÑÐ¸Ð² Ñ‚Ñ€ÐµÐ±ÑƒÐµÐ¼Ñ‹Ñ… Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²
    tools=("git" "python3" "python3-venv" "python3-pip")
    
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð»Ð¸ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚
    for tool in "${tools[@]}"; do
        if ! dpkg -l | grep -q $tool; then
            log_info "Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ $tool..."
            apt update
            apt install -y $tool
            if [ $? -ne 0 ]; then
                log_error "ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ $tool. ÐŸÑ€ÐµÑ€Ñ‹Ð²Ð°ÐµÐ¼ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ."
                exit 1
            fi
        fi
    done
}

# ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ ÑÐµÑ€Ð²Ð¸ÑÐ°
setup_user() {
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð»Ð¸ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð¾Ñ‚ Ð¸Ð¼ÐµÐ½Ð¸ root
    if [ "$(id -u)" -eq 0 ]; then
        log_info "Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð¾Ñ‚ Ð¸Ð¼ÐµÐ½Ð¸ root."
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ dopaminebot
        if ! id "dopaminebot" &>/dev/null; then
            log_info "Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ dopaminebot Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²Ð¸ÑÐ°..."
            useradd -m -s /bin/bash dopaminebot
        fi
        
        SERVICE_USER="dopaminebot"
    else
        # Ð•ÑÐ»Ð¸ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ðµ Ð¾Ñ‚ root, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        SERVICE_USER="$USER"
    fi
    
    log_info "Ð¡ÐµÑ€Ð²Ð¸Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð¾Ñ‚ Ð¸Ð¼ÐµÐ½Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ: $SERVICE_USER"
}

# Ð—Ð°Ð´Ð°ÐµÐ¼ Ð¿ÑƒÑ‚Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸
INSTALL_DIR="/opt/dopamine_bank"
BACKUP_DIR="/opt/dopamine_bank_backup"
SERVICE_NAME="dopamine_bank"
REPO_URL="https://github.com/sandexzx/dopamineBankShortVersion.git"

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±ÑÐºÐ°Ð¿Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…, ÐµÑÐ»Ð¸ Ð±Ð¾Ñ‚ ÑƒÐ¶Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½
backup_data() {
    if [ -d "$INSTALL_DIR" ]; then
        log_info "ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð° ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð°Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°. Ð¡Ð¾Ð·Ð´Ð°ÑŽ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½ÑƒÑŽ ÐºÐ¾Ð¿Ð¸ÑŽ Ð´Ð°Ð½Ð½Ñ‹Ñ…..."
        
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ Ð±ÑÐºÐ°Ð¿Ð°, ÐµÑÐ»Ð¸ ÐµÑ‘ Ð½ÐµÑ‚
        mkdir -p $BACKUP_DIR
        
        # ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐµÐ¼ Ñ„Ð°Ð¹Ð»Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
        if [ -f "$INSTALL_DIR/users.json" ]; then
            cp "$INSTALL_DIR/users.json" "$BACKUP_DIR/"
        fi
        
        if [ -f "$INSTALL_DIR/rewards.json" ]; then
            cp "$INSTALL_DIR/rewards.json" "$BACKUP_DIR/"
        fi
        
        log_info "Ð‘ÑÐºÐ°Ð¿ Ð´Ð°Ð½Ð½Ñ‹Ñ… ÑÐ¾Ð·Ð´Ð°Ð½ Ð² $BACKUP_DIR"
    else
        log_info "Ð¡ÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð°Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð½Ðµ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð°. Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð½Ð¾Ð²Ð°Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°."
    fi
}

# ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÑÐµÑ€Ð²Ð¸ÑÐ°, ÐµÑÐ»Ð¸ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚
stop_service() {
    if systemctl is-active --quiet $SERVICE_NAME; then
        log_info "ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÑŽ ÑÐµÑ€Ð²Ð¸Ñ $SERVICE_NAME..."
        systemctl stop $SERVICE_NAME
    fi
}

# Ð¡ÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð»Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
get_repo() {
    if [ -d "$INSTALL_DIR" ]; then
        log_info "ÐžÐ±Ð½Ð¾Ð²Ð»ÑÑŽ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ Ð¸Ð· Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ..."
        cd $INSTALL_DIR
        git pull
    else
        log_info "ÐšÐ»Ð¾Ð½Ð¸Ñ€ÑƒÑŽ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹..."
        mkdir -p $INSTALL_DIR
        git clone $REPO_URL $INSTALL_DIR
    fi
    
    # Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
    if [ "$(id -u)" -eq 0 ]; then
        chown -R $SERVICE_USER:$SERVICE_USER $INSTALL_DIR
    fi
}

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
setup_venv() {
    log_info "ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÑŽ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ Python..."
    
    # ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ÑÑ Ð½Ð° Ð½ÑƒÐ¶Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ venv (ÐµÑÐ»Ð¸ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¾ Ð¾Ñ‚ root)
    if [ "$(id -u)" -eq 0 ]; then
        cd $INSTALL_DIR
        
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ, ÐµÑÐ»Ð¸ ÐµÐ³Ð¾ Ð½ÐµÑ‚
        if [ ! -d "$INSTALL_DIR/venv" ]; then
            su -c "python3 -m venv $INSTALL_DIR/venv" $SERVICE_USER
        fi
        
        # Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
        su -c "source $INSTALL_DIR/venv/bin/activate && pip install --upgrade pip && pip install -r $INSTALL_DIR/requirements.txt && deactivate" $SERVICE_USER
    else
        # Ð•ÑÐ»Ð¸ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ðµ Ð¾Ñ‚ root
        cd $INSTALL_DIR
        
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ, ÐµÑÐ»Ð¸ ÐµÐ³Ð¾ Ð½ÐµÑ‚
        if [ ! -d "$INSTALL_DIR/venv" ]; then
            python3 -m venv venv
        fi
        
        # Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
        source venv/bin/activate
        pip install --upgrade pip
        pip install -r requirements.txt
        deactivate
    fi
}

# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°
restore_data() {
    # Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ñ„Ð°Ð¹Ð»Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…, ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð±ÑÐºÐ°Ð¿
    if [ -f "$BACKUP_DIR/users.json" ]; then
        log_info "Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÑŽ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°..."
        cp "$BACKUP_DIR/users.json" "$INSTALL_DIR/"
    fi
    
    if [ -f "$BACKUP_DIR/rewards.json" ]; then
        log_info "Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÑŽ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð°Ð³Ñ€Ð°Ð´ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°..."
        cp "$BACKUP_DIR/rewards.json" "$INSTALL_DIR/"
    fi
    
    # Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
    if [ "$(id -u)" -eq 0 ]; then
        chown $SERVICE_USER:$SERVICE_USER "$INSTALL_DIR/users.json" 2>/dev/null
        chown $SERVICE_USER:$SERVICE_USER "$INSTALL_DIR/rewards.json" 2>/dev/null
    fi
}

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ systemd ÑÐµÑ€Ð²Ð¸ÑÐ°
create_service() {
    log_info "Ð¡Ð¾Ð·Ð´Ð°ÑŽ systemd ÑÐµÑ€Ð²Ð¸Ñ..."
    
    # Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ sudo Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð½Ðµ root
    if [ "$(id -u)" -eq 0 ]; then
        SUDO_CMD=""
    else
        SUDO_CMD="sudo"
    fi
    
    $SUDO_CMD tee /etc/systemd/system/$SERVICE_NAME.service > /dev/null <<EOL
[Unit]
Description=Dopamine Bank Telegram Bot
After=network.target

[Service]
Type=simple
User=$SERVICE_USER
WorkingDirectory=$INSTALL_DIR
ExecStart=$INSTALL_DIR/venv/bin/python main.py
Restart=always
RestartSec=5
Environment=PYTHONUNBUFFERED=1

[Install]
WantedBy=multi-user.target
EOL

    # ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ systemd Ð¸ Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ ÑÐµÑ€Ð²Ð¸Ñ
    $SUDO_CMD systemctl daemon-reload
    $SUDO_CMD systemctl enable $SERVICE_NAME
}

# Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²Ð¸ÑÐ°
start_service() {
    log_info "Ð—Ð°Ð¿ÑƒÑÐºÐ°ÑŽ ÑÐµÑ€Ð²Ð¸Ñ $SERVICE_NAME..."
    
    # Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ sudo Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð½Ðµ root
    if [ "$(id -u)" -eq 0 ]; then
        SUDO_CMD=""
    else
        SUDO_CMD="sudo"
    fi
    
    $SUDO_CMD systemctl start $SERVICE_NAME
    
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ° ÑÐµÑ€Ð²Ð¸ÑÐ°
    if systemctl is-active --quiet $SERVICE_NAME; then
        log_info "Ð¡ÐµÑ€Ð²Ð¸Ñ $SERVICE_NAME ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½! ðŸš€"
    else
        log_error "ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ ÑÐµÑ€Ð²Ð¸Ñ $SERVICE_NAME. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸: journalctl -u $SERVICE_NAME"
    fi
}

# Ð’Ñ‹Ð²Ð¾Ð´ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ ÑÑ‚Ð°Ñ‚ÑƒÑÐµ Ð±Ð¾Ñ‚Ð°
show_status() {
    log_info "==========================="
    log_info "âœ… Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°!"
    log_info "==========================="
    log_info "ðŸ“ Ð”Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸: $INSTALL_DIR"
    log_info "ðŸ¤– Ð˜Ð¼Ñ ÑÐµÑ€Ð²Ð¸ÑÐ°: $SERVICE_NAME"
    log_info "ðŸ‘¤ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐµÑ€Ð²Ð¸ÑÐ°: $SERVICE_USER"
    log_info "ðŸ“Š ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚ÑƒÑ: systemctl status $SERVICE_NAME"
    log_info "ðŸ“ Ð›Ð¾Ð³Ð¸: journalctl -u $SERVICE_NAME -f"
    log_info "ðŸ”„ ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº: systemctl restart $SERVICE_NAME"
    log_info "==========================="
}

# ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸
main() {
    log_info "ðŸš€ ÐÐ°Ñ‡Ð¸Ð½Ð°ÑŽ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ/Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Dopamine Bank..."
    
    # ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²Ð¸ÑÐ°
    setup_user
    
    # Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð²ÑÐµ ÑˆÐ°Ð³Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸
    check_dependencies
    backup_data
    stop_service
    get_repo
    setup_venv
    restore_data
    create_service
    start_service
    show_status
}

# Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÑÐºÑ€Ð¸Ð¿Ñ‚
main